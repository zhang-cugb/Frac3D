# Frac3D/LowDimensionalFracture

Solution of 3D fluid flow problems in porous media with a low dimensional fracture.

## Problem Description

We denote the pressure field in the three-dimensional domain of the porous matrix as <a href="https://www.codecogs.com/eqnedit.php?latex=p_3" target="_blank"><img src="https://latex.codecogs.com/gif.latex?p_3" title="p_3" /></a> and the pressure field in the two-dimensional domain of the fracture as <a href="https://www.codecogs.com/eqnedit.php?latex=p_2" target="_blank"><img src="https://latex.codecogs.com/gif.latex?p_2" title="p_2" /></a>,. The problem is to find <a href="https://www.codecogs.com/eqnedit.php?latex=p_2" target="_blank"><img src="https://latex.codecogs.com/gif.latex?p_2" title="p_2" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=p_3" target="_blank"><img src="https://latex.codecogs.com/gif.latex?p_3" title="p_3" /></a>, such that

<a href="https://www.codecogs.com/eqnedit.php?latex=\begin{align*}&space;-\nabla\cdot\left(K_3\nabla&space;p_3\right)=0,&space;&\;\text{in}\;\Omega_3,&space;\\&space;p_3=\overline{p},&space;&\;\text{in}\;\partial\Omega_{3p},&space;\\&space;-K_3\nabla&space;p_3\cdot&space;n=0,&space;&\;\text{in}\;\partial\Omega_{3u},&space;\end{align*}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\begin{align*}&space;-\nabla\cdot\left(K_3\nabla&space;p_3\right)=0,&space;&\;\text{in}\;\Omega_3,&space;\\&space;p_3=\overline{p},&space;&\;\text{in}\;\partial\Omega_{3p},&space;\\&space;-K_3\nabla&space;p_3\cdot&space;n=0,&space;&\;\text{in}\;\partial\Omega_{3u},&space;\end{align*}" title="\begin{align*} -\nabla\cdot\left(K_3\nabla p_3\right)=0, &\;\text{in}\;\Omega_3, \\ p_3=\overline{p}, &\;\text{in}\;\partial\Omega_{3p}, \\ -K_3\nabla p_3\cdot n=0, &\;\text{in}\;\partial\Omega_{3u}, \end{align*}" /></a>

for the porous matrix and

<a href="https://www.codecogs.com/eqnedit.php?latex=\begin{align*}&space;-\nabla\cdot\left(K_2\nabla&space;p_2\right)&space;&plus;&space;[\![\kappa_2(p_2-p_3)]\!]=0,&space;&\;\text{in}\;\Omega_2,&space;\\&space;-K_2\nabla&space;p_2\cdot&space;n=0,&space;&\;\text{in}\;\partial\Omega_2,&space;\end{align*}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\begin{align*}&space;-\nabla\cdot\left(K_2\nabla&space;p_2\right)&space;&plus;&space;[\![\kappa_2(p_2-p_3)]\!]=0,&space;&\;\text{in}\;\Omega_2,&space;\\&space;-K_2\nabla&space;p_2\cdot&space;n=0,&space;&\;\text{in}\;\partial\Omega_2,&space;\end{align*}" title="\begin{align*} -\nabla\cdot\left(K_2\nabla p_2\right) + [\![\kappa_2(p_2-p_3)]\!]=0, &\;\text{in}\;\Omega_2, \\ -K_2\nabla p_2\cdot n=0, &\;\text{in}\;\partial\Omega_2, \end{align*}" /></a>

for the fracture, where <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;K_3" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;K_3" title="K_3" /></a> is the permeability of the porous matrix, while <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;K_2" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;K_2" title="K_2" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\kappa_2" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\kappa_2" title="\kappa_2" /></a> are the permeability in the tangencial and normal directions of the fracture, respectively. Furthermore, <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;[\![\cdot]\!]" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;[\![\cdot]\!]" title="[\![\cdot]\!]" /></a> is given by the sum of <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;(\cdot)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;(\cdot)" title="(\cdot)" /></a> over the interface sections of <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\Gamma_2=\Omega_2\cap\Omega_3" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\Gamma_2=\Omega_2\cap\Omega_3" title="\Gamma_2=\Omega_2\cap\Omega_3" /></a>.

Using a domain decomposition approach for <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\textstyle\Omega_3=\Omega_{31}\cup\Omega_{32}\cup\Omega_{33}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\textstyle\Omega_3=\Omega_{31}\cup\Omega_{32}\cup\Omega_{33}" title="\textstyle\Omega_3=\Omega_{31}\cup\Omega_{32}\cup\Omega_{33}" /></a>, we introduce a Lagrange multiplier to handle the continuity of the solution across the interface <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\textstyle\gamma_{23}=\partial\Omega_{32}\cap\partial\Omega_{33}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\textstyle\gamma_{23}=\partial\Omega_{32}\cap\partial\Omega_{33}" title="\textstyle\gamma_{23}=\partial\Omega_{32}\cap\partial\Omega_{33}" /></a>. The resulting weak formulation is find <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;p_2\in&space;V(\Omega_2)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;p_2\in&space;V(\Omega_2)" title="p_2\in V(\Omega_2)" /></a>, <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;p_{31}\in&space;V(\Omega_{31})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;p_{31}\in&space;V(\Omega_{31})" title="p_{31}\in V(\Omega_{31})" /></a>, <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;p_{32}\in&space;V(\Omega_{32})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;p_{32}\in&space;V(\Omega_{32})" title="p_{32}\in V(\Omega_{32})" /></a>, <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;p_{33}\in&space;V(\Omega_{33})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;p_{33}\in&space;V(\Omega_{33})" title="p_{33}\in V(\Omega_{33})" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\lambda\in&space;E(\gamma_{23})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\lambda\in&space;E(\gamma_{23})" title="\lambda\in E(\gamma_{23})" /></a> such that

<a href="https://www.codecogs.com/eqnedit.php?latex=\int_{\Omega_{31}}K_{31}\nabla&space;p_{31}\cdot\nabla&space;v_{31}\;\text{d}x-\int_{\Gamma_2}\kappa_2(p_2-p_{31})v_{31}\text{d}s&plus;\int_{\Omega_{32}}K_{32}\nabla&space;p_{32}\cdot\nabla&space;v_{32}\;\text{d}x-\int_{\Gamma_2}\kappa_2(p_2-p_{32})v_{32}\text{d}s&plus;\int_{\Omega_{33}}K_{33}\nabla&space;p_{33}\cdot\nabla&space;v_{33}\;\text{d}x&plus;\int_{\gamma_{23}}\lambda\left(v_{32}-v_{33}\right)\text{d}s=0," target="_blank"><img src="https://latex.codecogs.com/gif.latex?\int_{\Omega_{31}}K_{31}\nabla&space;p_{31}\cdot\nabla&space;v_{31}\;\text{d}x-\int_{\Gamma_2}\kappa_2(p_2-p_{31})v_{31}\text{d}s&plus;\int_{\Omega_{32}}K_{32}\nabla&space;p_{32}\cdot\nabla&space;v_{32}\;\text{d}x-\int_{\Gamma_2}\kappa_2(p_2-p_{32})v_{32}\text{d}s&plus;\int_{\Omega_{33}}K_{33}\nabla&space;p_{33}\cdot\nabla&space;v_{33}\;\text{d}x&plus;\int_{\gamma_{23}}\lambda\left(v_{32}-v_{33}\right)\text{d}s=0," title="\int_{\Omega_{31}}K_{31}\nabla p_{31}\cdot\nabla v_{31}\;\text{d}x-\int_{\Gamma_2}\kappa_2(p_2-p_{31})v_{31}\text{d}s+\int_{\Omega_{32}}K_{32}\nabla p_{32}\cdot\nabla v_{32}\;\text{d}x-\int_{\Gamma_2}\kappa_2(p_2-p_{32})v_{32}\text{d}s+\int_{\Omega_{33}}K_{33}\nabla p_{33}\cdot\nabla v_{33}\;\text{d}x+\int_{\gamma_{23}}\lambda\left(v_{32}-v_{33}\right)\text{d}s=0," /></a>
<a href="https://www.codecogs.com/eqnedit.php?latex=\int_{\Omega_2}K_2\nabla&space;p_2\cdot\nabla&space;v_2\;\text{d}x&plus;\int_{\Gamma_2}\kappa_2(p_2-p_{31})\text{d}s&plus;\int_{\Gamma_2}\kappa_2(p_2-p_{32})\text{d}s=0," target="_blank"><img src="https://latex.codecogs.com/gif.latex?\int_{\Omega_2}K_2\nabla&space;p_2\cdot\nabla&space;v_2\;\text{d}x&plus;\int_{\Gamma_2}\kappa_2(p_2-p_{31})\text{d}s&plus;\int_{\Gamma_2}\kappa_2(p_2-p_{32})\text{d}s=0," title="\int_{\Omega_2}K_2\nabla p_2\cdot\nabla v_2\;\text{d}x+\int_{\Gamma_2}\kappa_2(p_2-p_{31})\text{d}s+\int_{\Gamma_2}\kappa_2(p_2-p_{32})\text{d}s=0," /></a>

for all <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;v_2\in&space;V(\Omega_2)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;v_2\in&space;V(\Omega_2)" title="v_2\in V(\Omega_2)" /></a>, <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;v_{31}\in&space;V(\Omega_{31})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;v_{31}\in&space;V(\Omega_{31})" title="v_{31}\in V(\Omega_{31})" /></a>, <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;v_{32}\in&space;V(\Omega_{32})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;v_{32}\in&space;V(\Omega_{32})" title="v_{32}\in V(\Omega_{32})" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;v_{33}\in&space;V(\Omega_{33})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;v_{33}\in&space;V(\Omega_{33})" title="v_{33}\in V(\Omega_{33})" /></a>, and

<a href="https://www.codecogs.com/eqnedit.php?latex=\int_{\gamma_{23}}\eta\left(p_{32}-p_{33}\right)\text{d}s=0," target="_blank"><img src="https://latex.codecogs.com/gif.latex?\int_{\gamma_{23}}\eta\left(p_{32}-p_{33}\right)\text{d}s=0," title="\int_{\gamma_{23}}\eta\left(p_{32}-p_{33}\right)\text{d}s=0," /></a>

for all <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\eta\in&space;E(\gamma_{23})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\eta\in&space;E(\gamma_{23})" title="\eta\in E(\gamma_{23})" /></a>.

## Numerical Solution

### Subdomains:

The domain is decomposed into three subdomains:
- Upper subdomain <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\Omega_{31}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\Omega_{31}" title="\Omega_{31}" /></a> (gray color, ID 19), with <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;K_{31}=10^{-6}\;\text{m}/\text{s}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;K_{31}=10^{-6}\;\text{m}/\text{s}" title="K_{31}=10^{-6}\;\text{m}/\text{s}" /></a>;
- Lower subdomain <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\Omega_{32}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\Omega_{32}" title="\Omega_{32}" /></a> (red color, ID 20), with <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;K_{32}=10^{-6}\;\text{m}/\text{s}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;K_{32}=10^{-6}\;\text{m}/\text{s}" title="K_{32}=10^{-6}\;\text{m}/\text{s}" /></a>;
- Bottom subdomain <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\Omega_{33}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\Omega_{33}" title="\Omega_{33}" /></a> (blue color, ID 18), with <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;K_{33}=10^{-5}\;\text{m}/\text{s}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;K_{33}=10^{-5}\;\text{m}/\text{s}" title="K_{33}=10^{-5}\;\text{m}/\text{s}" /></a>;
- Fracture subdomain <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\Omega_2" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\Omega_2" title="\Omega_2" /></a> (ID 29) between upper and lower subdomains, with <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;K_2=10^{-3}\;\text{m}/\text{s}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;K_2=10^{-3}\;\text{m}/\text{s}" title="K_2=10^{-3}\;\text{m}/\text{s}" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\kappa_2=20\;\text{s}^{-1}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\kappa_2=20\;\text{s}^{-1}" title="\kappa_2=20\;\text{s}^{-1}" /></a>.

<p float="left">
	<img src="figs/Subdomains.png" alt="subdomains" height=300/>
</p>

### Boundaries:

The boundaries are subdivided into two Dirichlet boundaries and one Neumann boundary:
- Dirichlet boundary <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\partial\Omega_{31p}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\partial\Omega_{31p}" title="\partial\Omega_{31p}" /></a> (narrow band defined by <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\left(0\;\text{m},&space;0\;\text{m}\right)\times\left(0\;\text{m},&space;100\;\text{m}\right)\times\left(90\;\text{m},&space;100\;\text{m}\right)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\left(0\;\text{m},&space;0\;\text{m}\right)\times\left(0\;\text{m},&space;100\;\text{m}\right)\times\left(90\;\text{m},&space;100\;\text{m}\right)" title="\left(0\;\text{m}, 0\;\text{m}\right)\times\left(0\;\text{m}, 100\;\text{m}\right)\times\left(90\;\text{m}, 100\;\text{m}\right)" /></a>, ID 32), with prescribed <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;p_{31}=4\;\text{m}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;p_{31}=4\;\text{m}" title="p_{31}=4\;\text{m}" /></a>;
- Dirichlet boundary <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\partial\Omega_{33p}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\partial\Omega_{33p}" title="\partial\Omega_{33p}" /></a> (narrow band defined by <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\left(0\;\text{m},&space;100\;\text{m}\right)\times\left(0\;\text{m},&space;0\;\text{m}\right)\times\left(0\;\text{m},&space;10\;\text{m}\right)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\left(0\;\text{m},&space;100\;\text{m}\right)\times\left(0\;\text{m},&space;0\;\text{m}\right)\times\left(0\;\text{m},&space;10\;\text{m}\right)" title="\left(0\;\text{m}, 100\;\text{m}\right)\times\left(0\;\text{m}, 0\;\text{m}\right)\times\left(0\;\text{m}, 10\;\text{m}\right)" /></a>, ID 31), with prescribed <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;p_{33}=1\;\text{m}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;p_{33}=1\;\text{m}" title="p_{33}=1\;\text{m}" /></a>;
- Neumann boundary <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\partial\Omega_u=\partial\Omega-\left(\partial\Omega_{31p}\cup\partial\Omega_{33p}\right)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\partial\Omega_u=\partial\Omega-\left(\partial\Omega_{31p}\cup\partial\Omega_{33p}\right)" title="\partial\Omega_u=\partial\Omega-\left(\partial\Omega_{31p}\cup\partial\Omega_{33p}\right)" /></a>.

<p float="left">
	<img src="figs/Boundaries.png" alt="boundaries" height=300/>
</p>

### Results:

The solution is obtained using second degree CG elements for the pressure field and Lagrange multiplier and zero-order DG elements for the permeability field.

<p float="left">
	<img src="figs/Solution.png" alt="solution" height=300/>
</p>

The pressure field was plotted along the line <a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\left(0\;\text{m},&space;100\;\text{m},&space;100\;\text{m}\right)-\left(100\;\text{m},&space;0\;\text{m},&space;0\;\text{m}\right)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\left(0\;\text{m},&space;100\;\text{m},&space;100\;\text{m}\right)-\left(100\;\text{m},&space;0\;\text{m},&space;0\;\text{m}\right)" title="\left(0\;\text{m}, 100\;\text{m}, 100\;\text{m}\right)-\left(100\;\text{m}, 0\;\text{m}, 0\;\text{m}\right)" /></a> against the arc length and compared to the benchmark solution provided by [Berre <i>et al</i> (2020)](https://arxiv.org/abs/2002.07005).

<p float="left">
	<img src="figs/Benchmark.png" alt="solution" height=300/>
</p>